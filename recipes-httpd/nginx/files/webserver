

server {
	listen 80;
	root /var/www/localhost/html/;
	return 301 https://$host$request_uri;
}

server {
	listen 443 ssl;
        server_name  localhost;

	ssl_certificate		/etc/gunicorn/cert.pem;
	ssl_certificate_key	/etc/gunicorn/cert.key;

	ssl_session_timeout  5m;

	ssl_protocols  SSLv2 SSLv3 TLSv1;
	ssl_ciphers  HIGH:!aNULL:!MD5;
	ssl_prefer_server_ciphers   on;

        #charset koi8-r;

        #access_log  logs/host.access.log  main;

	location = /favicon.ico {
		expires 30d;
		root /var/www/localhost/html/images;
        	try_files /favicon.png /favicon.png;
    	}
	
	location ~ ^/(images|media|.well-known|css|js|fonts)/ {
		expires 30d;
		root /var/www/localhost/html/;
        	try_files $uri $uri/ =404;
   	 }
	
	location /request_login {
		include proxy_params;
        	proxy_pass http://unix:/etc/gunicorn/gunicorn.sock;
    	}
	location /socket.io/ {
		proxy_http_version 1.1;
        	proxy_buffering off;
		
        	proxy_set_header Upgrade $http_upgrade;
        	proxy_set_header Connection "Upgrade";
		
        	include proxy_params;
        	proxy_pass http://unix:/etc/gunicorn/gunicorn.sock;
    	}
	location / {
		include proxy_params;
		proxy_pass http://unix:/etc/gunicorn/gunicorn.sock;
	}

    }

